<!doctype html>
<html>
  <head>
    <meta charset="utf-8">
    <meta content="IE=edge,chrome=1" http-equiv="X-UA-Compatible">
    <meta name="viewport" content="width=device-width; initial-scale=1.0; maximum-scale=1.0; user-scalable=yes;" />

    <title>SPEEDREAD</title>

    <link href='http://fonts.googleapis.com/css?family=Comfortaa:300' rel='stylesheet' type='text/css'>
    <link href='http://fonts.googleapis.com/css?family=Open+Sans:400,800,300' rel='stylesheet' type='text/css'>

    <script>
      window.addEventListener("load",function() {
        setTimeout(function(){
          window.scrollTo(0, 0);
        }, 0);
      });
    </script>

    <link href="/stylesheets/all.css" media="screen" rel="stylesheet" type="text/css" />
    <script src="/javascripts/all.js" type="text/javascript"></script>
    <link href="/stylesheets/print.css" media="print" rel="stylesheet" type="text/css">
  </head>

  <body id='body' class="speedread speedread_index">

    <a href='/' class='jpoz '>JPoz</a>
    <a href='/photos' class='jpoz_photos inactive'>&nbsp;</a>
    <div class='contacts '>
      <a target='_blank' href='http://github.com/jpoz' class='contact github'>&nbsp;</a>
      <a target='_blank' href='http://twitter.com/jpoz' class='contact twitter'>&nbsp;</a>
      <a target='_blank' href='http://instagram.com/jpoz' class='contact instagram'>&nbsp;</a>
    </div>

    <div id='content'>
      <div id='speedread'>
  <div class='speedread-title'>
    Insert text you'd like to speed read
  </div>
  <div class='speedread-input-container'>
    <textarea id='speedread-input'></textarea>
  </div>
  <div class='speedread-controls'>
    Words per minute:
    <input id='speedread-word-per-min' type='number' value='500'/>

    <button id='speedread-go-button'>
      Go
    </button>
  </div>

  <div id='speedread-overlay' class='speedread-overlay hidden'>
    <div id='speedread-words' class='speedread-words'>
      http://localhost:4567/speedread
    </div>
  </div>
</div>

<script>
  let input = document.getElementById('speedread-input');
  let button = document.getElementById('speedread-go-button');
  let overlay = document.getElementById('speedread-overlay');
  let word_display = document.getElementById('speedread-words');
  let words_per_min = document.getElementById('speedread-word-per-min');
  let overlay_shown = false;

  button.onclick = async function(e) {
    let words = input.value.trim();
    words = words.replace(/^\s{2,}/g, ' ⇥' );
    words = words.replace(/\s{2,}/g, ' ');
    words = words.replace(/\t/g, '⇥');
    words = words.replace(/\n/g, ' ↩︎ ');

    overlay.classList.remove("hidden");
    overlay_shown = true;

    let word_list = words.split(' ');
    let word_size = word_list.length;

    next_word = function(index) {
      word = word_list[index];
      word_display.innerHTML = word;
      if (word_size > index && overlay_shown) {
        let timeout = 60000 / words_per_min.value;
        setTimeout(next_word, timeout, index+1)
      } else {
        overlay_shown = false;
        overlay.classList.add("hidden");
      }
    }

    next_word(0);
  }
  overlay.onclick = function(e) {
    overlay_shown = false;
    overlay.classList.add("hidden");
  }
</script>

    </div>
    <script type="text/javascript">

      var _gaq = _gaq || [];
      _gaq.push(['_setAccount', 'UA-3441225-6']);
      _gaq.push(['_trackPageview']);

      (function() {
        var ga = document.createElement('script'); ga.type = 'text/javascript'; ga.async = true;
        ga.src = ('https:' == document.location.protocol ? 'https://ssl' : 'http://www') + '.google-analytics.com/ga.js';
        var s = document.getElementsByTagName('script')[0]; s.parentNode.insertBefore(ga, s);
      })();

    </script>
  </body>
</html>
